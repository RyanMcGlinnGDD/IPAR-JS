!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(){j=document.getElementById("window"),h=document.getElementById("canvas"),i=h.getContext("2d"),l=document.getElementById("proceedContainer"),m=document.getElementById("proceedBtnLong"),n=document.getElementById("proceedBtnRound"),h.width=h.offsetWidth,h.height=h.offsetHeight,k=document.getElementById("windowFlim"),k.onclick=function(){j.innerHTML=""},p=Date.now(),q=0,g=new r(localStorage.caseFiles,h,j),o=document.getElementById("zoom-slider"),o.oninput=function(){g.updateZoom(-parseFloat(o.value))},document.getElementById("zoom-in").onclick=function(){o.stepDown(),g.updateZoom(-parseFloat(o.value))},document.getElementById("zoom-out").onclick=function(){o.stepUp(),g.updateZoom(-parseFloat(o.value))},g.onChangeBoard=function(){o.value=-g.getZoom()},g.scale=u.getScale(t.boardSize,new s(h.width,h.height))}function e(){window.requestAnimationFrame(e.bind(this)),q=Date.now()-p,p=Date.now(),g.update(i,h,q),g.active&&""!=j.innerHTML&&v++>3?(g.active=!1,k.style.display="block"):0!=v&&""==j.innerHTML&&f()}function f(){v=0,g.active=!0,k.style.display="none",l.style.display="none",g.windowClosed()}var g,h,i,j,k,l,m,n,o,p,q,r=a("./modules/game.js"),s=a("./modules/point.js"),t=(a("./modules/mouseState.js"),a("./modules/constants.js")),u=a("./modules/utilities.js"),v=0;window.onload=function(a){d(),e()},window.addEventListener("resize",function(a){h.width=h.offsetWidth,h.height=h.offsetHeight,g.scale=u.getScale(t.boardSize,new s(h.width,h.height))})},{"./modules/constants.js":5,"./modules/game.js":9,"./modules/mouseState.js":12,"./modules/point.js":13,"./modules/utilities.js":17}],2:[function(a,b,c){"use strict";function d(a,b){this.position=a,this.lessonNodeArray=b,this.boardOffset=a,this.prevBoardOffset={x:0,y:0},this.zoom=h.startZoom,this.stage=0,this.lastSaveTime=0,this.lastQuestion=null,this.lastQuestionNum=-1;for(var c=!0,d=0;d<this.lessonNodeArray.length&&c;d++)this.lessonNodeArray[d].currentState!=g.SOLVE_STATE.SOLVED&&(c=!1);c?this.finished=!0:this.finished=!1}var e=a("./utilities.js"),f=a("./point.js"),g=a("./question.js"),h=a("./constants.js"),i=a("./drawlib.js"),j=d.prototype;j.move=function(a,b){this.position.x+=a,this.position.y+=b,this.boardOffset={x:0,y:0},this.prevBoardOffset={x:0,y:0}},j.act=function(a,b){for(var c=0;c<this.lessonNodeArray.length;c++){var d=this.lessonNodeArray[c];if(d.currentState!=g.SOLVE_STATE.SOLVED&&d.question.currentState==g.SOLVE_STATE.SOLVED){for(var i=0;i<d.question.connections.length;i++)this.lessonNodeArray[d.question.connections[i]-1].connections++;d.currentState=d.question.currentState;for(var j=!0,c=0;c<this.lessonNodeArray.length&&j;c++)this.lessonNodeArray[c].currentState!=g.SOLVE_STATE.SOLVED&&(j=!1);j&&(this.finished=!0),this.updateNode&&this.updateNode()}d.question.currentState==g.SOLVE_STATE.SOLVED&&(d.linePercent=Math.min(1,b*h.lineSpeed+d.linePercent))}if(a){!a.mouseDown&&this.target&&(this.target.dragPosition=void 0,this.target.dragging=!1,this.target=null);for(var c=this.lessonNodeArray.length-1;c>=0&&null==this.target;c--){var k=this.lessonNodeArray[c];k.mouseOver=!1,e.mouseIntersect(a,k,this.boardOffset)&&(k.mouseOver=!0,this.target=k)}if(this.target)if(this.target.dragging){var l=a.virtualPosition.x-this.target.dragPosition.x;this.target.position.x=Math.max(h.boardOutline,Math.min(l,h.boardSize.x-h.boardOutline)),this.target.question.positionPercentX=this.target.position.x;var m=a.virtualPosition.y-this.target.dragPosition.y;this.target.position.y=Math.max(h.boardOutline,Math.min(m,h.boardSize.y-h.boardOutline)),this.target.question.positionPercentY=this.target.position.y}else a.mouseDown&&(this.target.dragging=!0,this.target.dragPosition=new f(a.virtualPosition.x-this.target.position.x,a.virtualPosition.y-this.target.position.y)),a.mouseClicked&&(this.target.click(a),this.lastQuestion=this.target.question,this.lastQuestionNum=c);null==this.target&&(a.mouseDown?(canvas.style.cursor="-webkit-grabbing",canvas.style.cursor="-moz-grabbing",canvas.style.cursor="grabbing",this.mouseStartDragBoard?(this.boardOffset.x=this.prevBoardOffset.x-(a.virtualPosition.x-this.mouseStartDragBoard.x),this.boardOffset.x>this.maxBoardWidth/2&&(this.boardOffset.x=this.maxBoardWidth/2),this.boardOffset.x<-1*this.maxBoardWidth/2&&(this.boardOffset.x=-1*this.maxBoardWidth/2),this.boardOffset.y=this.prevBoardOffset.y-(a.virtualPosition.y-this.mouseStartDragBoard.y),this.boardOffset.y>this.maxBoardHeight/2&&(this.boardOffset.y=this.maxBoardHeight/2),this.boardOffset.y<-1*this.maxBoardHeight/2&&(this.boardOffset.y=-1*this.maxBoardHeight/2)):(this.mouseStartDragBoard=a.virtualPosition,this.prevBoardOffset.x=this.boardOffset.x,this.prevBoardOffset.y=this.boardOffset.y)):(this.mouseStartDragBoard=void 0,canvas.style.cursor=""))}},j.draw=function(a,b){a.save(),a.translate(b.width/2,b.height/2),a.scale(this.zoom,this.zoom),a.translate(-b.width/2,-b.height/2),this.position=this.boardOffset,a.translate(b.width/2-this.position.x,b.height/2-this.position.y),i.rect(a,0,0,h.boardSize.x,h.boardSize.y,"#D3B185"),i.strokeRect(a,-h.boardOutline/2,-h.boardOutline/2,h.boardSize.x+h.boardOutline/2,h.boardSize.y+h.boardOutline/2,h.boardOutline,"#CB9966");for(var c=0;c<this.lessonNodeArray.length;c++)this.lessonNodeArray[c].draw(a,b);for(var c=0;c<this.lessonNodeArray.length;c++)if(this.lessonNodeArray[c].question.currentState==g.SOLVE_STATE.SOLVED){var d=this.lessonNodeArray[c].getNodePoint();a.strokeStyle="rgba(0,0,105,0.2)",a.lineWidth=1;for(var e=0;e<this.lessonNodeArray[c].question.connections.length;e++)if(this.lessonNodeArray[this.lessonNodeArray[c].question.connections[e]-1].question.currentState!=g.SOLVE_STATE.HIDDEN){var f=this.lessonNodeArray[this.lessonNodeArray[c].question.connections[e]-1],j=f.getNodePoint();a.beginPath(),a.moveTo(d.x,d.y),a.lineTo(d.x+(j.x-d.x)*this.lessonNodeArray[c].linePercent,d.y+(j.y-d.y)*this.lessonNodeArray[c].linePercent),a.closePath(),a.stroke()}}a.restore()},j.getFreeNode=function(){for(var a=0;a<this.lessonNodeArray.length;a++)if(this.lessonNodeArray[a].currentState==g.SOLVE_STATE.UNSOLVED)return this.lessonNodeArray[a];return null},j.moveTowards=function(a,b,c){var d=new f(a.x-this.boardOffset.x,a.y-this.boardOffset.y),e=Math.sqrt(d.x*d.x+d.y*d.y),g=new f(this.boardOffset.x+d.x/e*b*c,this.boardOffset.y+d.y/e*b*c);this.boardOffset.x!=a.x&&Math.abs(a.x-g.x)/(a.x-g.x)==Math.abs(a.x-this.boardOffset.x)/(a.x-this.boardOffset.x)?this.boardOffset.x=g.x:this.boardOffset.x=a.x,this.boardOffset.y!=a.y&&Math.abs(a.y-g.y)/(a.y-g.y)==Math.abs(a.y-this.boardOffset.y)/(a.y-this.boardOffset.y)?this.boardOffset.y=g.y:this.boardOffset.y=a.y},j.windowClosed=function(){if(console.log("window closed"),4==this.lastQuestion.questionType){var a=this.lastQuestion.fileName,b=this.lastQuestion.blob,c=this.lastQuestionNum;return{blob:b,num:c,ext:a.substring(a.lastIndexOf("."),a.length)}}},b.exports=d},{"./constants.js":5,"./drawlib.js":7,"./point.js":13,"./question.js":14,"./utilities.js":17}],3:[function(a,b,c){"use strict";function d(a,b,c){this.position=position,this.width=b,this.height=c,this.clicked=!1,this.hovered=!1}d.drawLib=void 0;var e=d.prototype;e.draw=function(a){a.save();var b;b=this.hovered?"dodgerblue":"lightblue",boardButton.drawLib.rect(a,this.position.x-this.width/2,this.position.y-this.height/2,this.width,this.height,b),a.restore()},b.exports=d},{}],4:[function(a,b,c){"use strict";function d(a,b,c,d,f,g){this.name=a;var h=b.getElementsByTagName("button");this.questions=[];for(var i=0;i<h.length;i++)this.questions[i]=new e(h[i],c,d,f,g)}var e=a("./question.js");b.exports=d},{"./question.js":14}],5:[function(a,b,c){"use strict";var d=a("./point.js"),e=b.exports;e.boardSize=new d(1920,1080),e.boardOutline=e.boardSize.x>e.boardSize.y?e.boardSize.x/20:e.boardSize.y/20,e.startZoom=.5,e.endZoom=1.5,e.zoomSpeed=.001,e.zoomMoveSpeed=.75,e.lineSpeed=.002},{"./point.js":13}],6:[function(a,b,c){"use strict";var d=b.exports;d.clear=function(a,b,c,d,e){a.clearRect(b,c,d,e)},d.rect=function(a,b,c,d,e,f,g){a.save(),a.fillStyle=f,g?a.fillRect(b-d/2,c-e/2,d,e):a.fillRect(b,c,d,e),a.restore()},d.strokeRect=function(a,b,c,d,e,f,g,h){a.save(),a.strokeStyle=g,a.lineWidth=f,h?a.strokeRect(b-d/2,c-e/2,d,e):a.strokeRect(b,c,d,e),a.restore()},d.line=function(a,b,c,d,e,f,g){a.save(),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.lineWidth=f,a.strokeStyle=g,a.stroke(),a.restore()},d.circle=function(a,b,c,d,e){a.save(),a.beginPath(),a.arc(b,c,d,0,2*Math.PI,!1),a.fillStyle=e,a.fill(),a.restore()}},{}],7:[function(a,b,c){arguments[4][6][0].apply(c,arguments)},{dup:6}],8:[function(a,b,c){"use strict";function d(a,b,c,d){window.resolveLocalFileSystemURL(b+"active/saveFile.ipardata",function(b){b.file(function(b){var c=new FileReader;c.onloadend=function(){var b=s.getXml(this.result);t.assignQuestionStates(a,b.getElementsByTagName("question"));var c=b.getElementsByTagName("case")[0].getAttribute("caseStatus");d(a,c)},c.readAsText(b)},function(a){console.log("Error: "+a.message)})})}function e(a,b,c){var d=s.getXml(a);t.assignQuestionStates(b,d.getElementsByTagName("question"));var e=d.getElementsByTagName("case")[0].getAttribute("caseStatus");c(b,e)}function f(a){if(!v)return void alert("CANNOT SAVE: file data did not load");var b=h(a),c=t.recreateCaseFile(a);i(c,b)}function g(a,b,c,d){console.log("create zip run");var e=new JSZip;b.forEach(function(a,b){e.file(c[b],a)}),d.names.forEach(function(a,b){e.file("case\\active\\submitted\\"+a,d.blobs[b])}),e.file("case\\active\\saveFile.ipardata",a),j(e)}function h(a){for(var b=[],c=[],d=0;d<a.length;d++)for(var e=0;e<a[d].lessonNodeArray.length;e++){var f=a[d].lessonNodeArray[e].question;f.fileName&&f.blob&&(b.push(f.fileName),c.push(f.blob))}return{names:b,blobs:c}}function i(a,b){var c=[],d=[],e=0;v.forEach(function(f){f.isFile&&(e++,f.file(function(h){var i=new FileReader;i.onloadend=function(h){var i=new Uint8Array(this.result);c.push(i),d.push(f.fullPath.replace(new RegExp("/","g"),"\\").substring(1)),c.length==e&&g(a,c,d,b)},i.readAsArrayBuffer(h)},k))})}function j(a){console.log("downloading"),console.log(a.generateAsync);a.generateAsync({type:"blob"}).then(function(a){var b=document.createElement("a");b.innerHTML=localStorage.caseName,b.setAttribute("class","downloadLink"),b.href=window.URL.createObjectURL(a),b.download=localStorage.caseName;var c=!1;c?document.body.appendChild(b):b.click()},function(a){blobLink.innerHTML+=" "+a})}function k(){console.log("yo we got errors")}function l(a){return Array.prototype.slice.call(a||[],0)}function m(a){console.log("recursivelyReadFiles called"),y=a;var b=a.root.createReader(),c=[],d=function(a){a.readEntries(function(b){if(b.length){var e=l(b);c=c.concat(e);for(var f=0;f<e.length;f++)if(e[f].isDirectory){var g=e[f].createReader();d(g)}d(a)}else n(c)},k)};d(b)}function n(a,b){v=a,b&&b(v)}function o(a){console.log("base URL: "+x);var b=z.filename,c=b.substring(0,b.lastIndexOf("/"));c.indexOf("case/")>-1&&(c=c.substring(5)),console.log("ext: "+c),window.resolveLocalFileSystemURL(x+c,a)}function p(a){var b=z.filename;console.log("addFileToDir("+b+", "+a+")");var c=a;if(console.log("curdir: "+c.name),!b.endsWith("\\")){c.getFile(b.substr(b.lastIndexOf("/")+1),{create:!0},q)}}function q(a){console.log(a),a.createWriter(r)}function r(a){console.log(a),a.onwriteend=function(a){console.log("write completed")},a.onerror=function(a){console.log("writer error: "+a.toString())},a.write(z.data),z.callback&&callback(file.toURL())}var s=(a("./category.js"),a("./resources.js"),a("./utilities.js")),t=(a("./constants.js"),a("./iparDataParser.js")),u=a("./questionWindows.js");window.resolveLocalFileSystemURL=window.resolveLocalFileSystemURL||window.webkitResolveLocalFileSystemURL;var v,w=b.exports,x=localStorage.caseFiles,y=null,z={filename:"",blob:"",callback:void 0};w.loadCase=function(a,b,c){this.categories=[],this.questions=[];var f=new u(function(){window.resolveLocalFileSystemURL(a+"active/caseFile.ipardata",function(g){g.file(function(g){var h=new FileReader;h.onloadend=function(){var g=s.getXml(this.result),h=t.getCategoriesAndQuestions(g,a,b,f),i=localStorage.getItem("autosave");i?e(i,h,c):d(h,a,b,c),window.webkitRequestFileSystem(window.TEMPORARY,1048576,m,k)},h.readAsText(g)},function(a){console.log("Error: "+a.message)})})})},w.prepareZip=function(a){console.log("prepare zip");var b=document.getElementById("blob");JSZip.support.blob&&(console.log("supports blob"),b.onclick=function(){f(a)})},w.addFileToSystem=function(a,b,c){if(console.log("fs: "+y.root),!y)return void retrieveFileSystem(function(){w.addFileToSystem(a,b,c)});for(var d=a.substr(0,a.lastIndexOf("\\")).split("\\"),e=y.root,f=0;f<d.length;f++)console.log(e.getDirectory(d[f])),e=e.getDirectory(d[f],{create:!0,exclusive:!1});if(!a.endsWith("\\")){var g=e.getFile(a.substr(a.lastIndexOf("\\")+1),{create:!0});g.createWriter().write(b),c&&c(g.toURL())}},w.addNewFileToSystem=function(a,b,c){a.indexOf("\\")>-1&&(a=s.replaceAll(a,"\\","/")),a.indexOf("/")<0&&(a="case/active/submitted/"+a),z.filename=a,z.data=b,z.callback=c,console.log("addFileToSystem("+a+", "+b+", "+c+")"),o(p)}},{"./category.js":4,"./constants.js":5,"./iparDataParser.js":10,"./questionWindows.js":15,"./resources.js":16,"./utilities.js":17}],9:[function(a,b,c){"use strict";function d(a,b,c){var d=this;this.active=!1,this.mouseState=new k(b),l.loadCase(a,c,function(a,b){d.categories=a,d.createLessonNodes()})}var e=a("./board.js"),f=a("./point.js"),g=a("./lessonNode.js"),h=a("./constants.js"),i=a("./drawlib.js"),j=a("./iparDataParser.js"),k=a("./mouseState.js"),l=a("./fileManager.js"),m=d.prototype;m.createLessonNodes=function(){this.boardArray=[];for(var a=document.getElementById("bottomBar"),b=0;b<this.categories.length;b++){this.lessonNodes=[];for(var c=0;c<this.categories[b].questions.length;c++)this.lessonNodes.push(new g(new f(this.categories[b].questions[c].positionPercentX,this.categories[b].questions[c].positionPercentY),this.categories[b].questions[c].imageLink,this.categories[b].questions[c])),this.lessonNodes[this.lessonNodes.length-1].question=this.categories[b].questions[c];this.boardArray.push(new e(new f(canvas.width/(2*this.scale),canvas.height/(2*this.scale)),this.lessonNodes));var d=document.createElement("BUTTON");d.innerHTML=this.categories[b].name;var h=this;d.onclick=function(a){return function(){h.active&&(h.activeBoardIndex=a,h.onChangeBoard&&h.onChangeBoard(),h.updateNode())}}(b),this.boardArray[this.boardArray.length-1].finished||(d.disabled=!0),a.appendChild(d),this.boardArray[this.boardArray.length-1].button=d;var h=this;this.boardArray[this.boardArray.length-1].updateNode=function(){h.updateNode()}}this.activeBoardIndex=0,this.active=!0,this.boardArray[this.activeBoardIndex].button.disabled=!1,h.onChangeBoard&&h.onChangeBoard(),this.updateNode(),l.prepareZip(this.boardArray)},m.updateZoom=function(a){this.active&&(this.boardArray[this.activeBoardIndex].zoom=a)},m.getZoom=function(){return this.boardArray[this.activeBoardIndex].zoom},m.update=function(a,b,c){if(this.active){if(this.mouseState.update(c,this.scale*this.boardArray[this.activeBoardIndex].zoom),this.mouseState.mouseClicked&&localStorage.setItem("autosave",j.createXMLSaveFile(this.boardArray,!1)),this.boardArray[this.activeBoardIndex].act(this.zoomin||this.zoomout?null:this.mouseState,c),this.activeBoardIndex<this.boardArray.length-1&&this.boardArray[this.activeBoardIndex+1].button.disabled&&this.boardArray[this.activeBoardIndex].finished&&(this.boardArray[this.activeBoardIndex+1].button.disabled=!1),this.zoomout){var d=this.boardArray[this.activeBoardIndex];this.getZoom()>h.startZoom?d.zoom-=c*h.zoomSpeed:this.getZoom()<h.startZoom&&(d.zoom=h.startZoom),d.moveTowards(new f(h.boardSize.x/2,h.boardSize.y/2),c,h.zoomMoveSpeed),this.onChangeBoard&&this.onChangeBoard(),this.getZoom()==h.startZoom&&d.boardOffset.x==h.boardSize.x/2&&d.boardOffset.y==h.boardSize.y/2&&(this.zoomout=!1)}else if(this.zoomin){var d=this.boardArray[this.activeBoardIndex];d.finished||null!=this.targetNode?d.finished&&(this.zoomin=!1,this.zoomout=!0):this.targetNode=d.getFreeNode(),this.zoomin&&this.targetNode&&(this.getZoom()<h.endZoom?d.zoom+=c*h.zoomSpeed:this.getZoom()>h.endZoom&&(d.zoom=h.endZoom),d.moveTowards(this.targetNode.position,c,h.zoomMoveSpeed),this.onChangeBoard&&this.onChangeBoard(),this.getZoom()==h.endZoom&&d.boardOffset.x==this.targetNode.position.x&&d.boardOffset.y==this.targetNode.position.y&&(this.zoomin=!1,this.targetNode=null))}this.draw(a,b)}},m.draw=function(a,b){i.rect(a,0,0,b.width,b.height,"#15718F"),a.save(),a.translate(b.width/2,b.height/2),a.scale(this.scale,this.scale),a.translate(-b.width/2,-b.height/2),this.boardArray[this.activeBoardIndex].draw(a,b),a.restore()},m.updateNode=function(){this.zoomin=!0},m.windowClosed=function(){var a=this.boardArray[this.activeBoardIndex].windowClosed();a&&l.addNewFileToSystem(""+this.activeBoardIndex+"-"+a.num+"-0"+a.ext,a.blob)},b.exports=d},{"./board.js":2,"./constants.js":5,"./drawlib.js":7,"./fileManager.js":8,"./iparDataParser.js":10,"./lessonNode.js":11,"./mouseState.js":12,"./point.js":13}],10:[function(a,b,c){"use strict";var d=a("./category.js"),e=a("./resources.js"),f=a("./utilities.js"),g=a("./constants.js"),h=a("./question.js");a("./questionWindows.js");window.resolveLocalFileSystemURL=window.resolveLocalFileSystemURL||window.webkitResolveLocalFileSystemURL;var i={hidden:h.SOLVE_STATE.HIDDEN,unsolved:h.SOLVE_STATE.UNSOLVED,correct:h.SOLVE_STATE.SOLVED},j=["hidden","unsolved","correct"],k=b.exports;k.assignQuestionStates=function(a,b){console.log("qelems: "+b.length);for(var c=0,d=0;d<a.length;d++)for(var e=0;e<a[d].questions.length;e++,c++){var j=a[d].questions[e],k=b[c];parseInt(k.getAttribute("positionPercentX"))<0||parseInt(k.getAttribute("positionPercentY"))<0||(j.currentState=i[k.getAttribute("questionState")],j.justification&&(j.justification.value=k.getAttribute("justification")),j.currentState==h.SOLVE_STATE.SOLVED&&j.correctAnswer(),j.positionPercentX=f.map(parseInt(k.getAttribute("positionPercentX")),0,100,0,g.boardSize.x),j.positionPercentY=f.map(parseInt(k.getAttribute("positionPercentY")),0,100,0,g.boardSize.y))}},k.getCategoriesAndQuestions=function(a,b,c,f){if(null!=a){for(var g=a.getElementsByTagName("resourceList")[0].getElementsByTagName("resource"),h=[],i=0;i<g.length;i++)h[i]=new e(g[i],b);for(var j=a.getElementsByTagName("category"),k=a.getElementsByTagName("categoryList")[0].getElementsByTagName("element"),l=[],i=0;i<j.length;i++)l[i]=new d(k[i].innerHTML,j[i],h,b,c,f);return l}return null},k.recreateCaseFile=function(a){var b=k.createXMLSaveFile(a,!0);return console.log("saveData.ipar data created"),b},k.createXMLSaveFile=function(a,b){var c;c=b?"\n":"";var d='<?xml version="1.0" encoding="utf-8"?>'+c;d+='<case categoryIndex="3" caseStatus="1" profileFirst="j" profileLast="j" profileMail="j">'+c,d+="<questions>"+c;for(var e=0;e<a.length;e++)for(var h=0;h<a[e].lessonNodeArray.length;h++){var i=a[e].lessonNodeArray[h].question;d+="<question ",d+='questionState="'+j[i.currentState]+'" ';var k,l=i.justification.value;k=l?l:i.justificationString,d+='justification="'+k+'" ',d+='animated="'+(2==i.currentState)+'" ',d+='linesTraced="0" ',d+='revealBuffer="0" ',d+='positionPercentX="'+f.map(i.positionPercentX,0,g.boardSize.x,0,100)+'" ',d+='positionPercentY="'+f.map(i.positionPercentY,0,g.boardSize.y,0,100)+'" ',d+="/>"+c}return d+="</questions>"+c,d+="</case>"+c}},{"./category.js":4,"./constants.js":5,"./question.js":14,"./questionWindows.js":15,"./resources.js":16,"./utilities.js":17}],11:[function(a,b,c){"use strict";function d(a,b,c){this.position=a,this.dragLocation=void 0,this.mouseOver=!1,this.dragging=!1,this.type="lessonNode",this.image=new Image,this.check=new Image,this.width,this.height,this.question=c,this.connections=0,this.currentState=this.question.currentState,this.linePercent=0,c.currentState==e.SOLVE_STATE.SOLVED&&(this.linePercent=1);var d=this;this.image.onload=function(){d.width=d.image.naturalWidth,d.height=d.image.naturalHeight;var a=f.boardSize.x/10;if(d.width<a&&d.height<a){var b;b=d.width>d.height?a/d.width:a/d.height,d.width=d.width*b,d.height=d.height*b}if(d.width>a||d.height>a){var b;b=d.width>d.height?d.width/a:d.height/a,d.width=d.width/b,d.height=d.height/b}d.position.x+=d.width/2,d.position.y+=d.height/2},this.image.src=b,this.check.src=h}var e=(a("./drawLib.js"),a("./question.js")),f=a("./constants.js"),g=a("./point.js"),e=a("./question.js"),h="../img/iconPostItCheck.png",i=d.prototype;i.draw=function(a,b){if(this.question.currentState==e.SOLVE_STATE.HIDDEN){if(!(this.question.revealThreshold<=this.connections))return;this.question.currentState=e.SOLVE_STATE.UNSOLVED,this.currentState=this.question.currentState}switch(a.save(),this.dragging?(a.shadowColor="yellow",a.shadowBlur=5,b.style.cursor="-webkit-grabbing",b.style.cursor="-moz-grabbing",b.style.cursor="grabbing"):this.mouseOver&&(a.shadowColor="dodgerBlue",a.shadowBlur=5,b.style.cursor="pointer"),a.drawImage(this.image,this.position.x-this.width/2,this.position.y-this.height/2,this.width,this.height),this.question.currentState){case 1:a.fillStyle="blue",a.strokeStyle="cyan";break;case 2:a.drawImage(this.check,this.position.x+this.width/2-f.boardSize.x/50,this.position.y+this.height/2-f.boardSize.x/50,f.boardSize.x/50,f.boardSize.x/50),a.fillStyle="green",a.strokeStyle="yellow"}var c=this.width<this.height?this.width:this.height;a.lineWidth=c/32,a.beginPath();var d=this.getNodePoint();a.arc(d.x,d.y,3*c/32,0,2*Math.PI),a.closePath(),a.fill(),a.stroke(),a.restore()},i.getNodePoint=function(){var a=this.width<this.height?this.width:this.height;return new g(this.position.x-this.width/2+3*a/16,this.position.y-this.height/2+3*a/16)},i.click=function(a){this.question.displayWindows()},b.exports=d},{"./constants.js":5,"./drawLib.js":6,"./point.js":13,"./question.js":14}],12:[function(a,b,c){"use strict";function d(a){e=new i(0,0),f=new i(0,0),this.virtualPosition=new i(0,0);var b=this;a.addEventListener("mousemove",function(b){var c=a.getBoundingClientRect();e=new i(b.clientX-c.left,b.clientY-c.top),f=new i(e.x-a.offsetWidth/2,e.y-a.offsetHeight/2)}),this.mouseDown=!1,a.addEventListener("mousedown",function(a){b.mouseDown=!0}),a.addEventListener("mouseup",function(a){b.mouseDown=!1}),this.mouseIn=!1,g=0,this.mouseClicked=!1,h=200,a.addEventListener("mouseover",function(a){b.mouseIn=!0}),a.addEventListener("mouseout",function(a){b.mouseIn=!1,b.mouseDown=!1})}var e,f,g,h,i=a("./point.js"),j=d.prototype;j.update=function(a,b){this.virtualPosition=new i(f.x/b,f.y/b),this.mouseClicked=!1,this.mouseDown?g+=a:(g>0&&h>g&&(this.mouseClicked=!0),g=0),this.prevMouseDown=this.mouseDown,this.hasTarget=!1},b.exports=d},{"./point.js":13}],13:[function(a,b,c){"use strict";function d(a,b){this.x=a,this.y=b}var e=d.prototype;e.add=function(a,b){return b?new d(this.x+a,this.y+b):new d(this.x+a.x,this.y+a.y)},e.mult=function(a,b){return b?new d(this.x*a,this.y*b):new d(this.x*a.x,this.y*a.y)},e.scale=function(a){return new d(this.x*a,this.y*a)},b.exports=d},{}],14:[function(a,b,c){"use strict";function d(a,b,c,d,h){this.currentState=g.HIDDEN,this.windowDiv=d,this.correct=parseInt(a.getAttribute("correctAnswer")),this.positionPercentX=e.map(parseInt(a.getAttribute("xPositionPercent")),0,100,0,f.boardSize.x),this.positionPercentY=e.map(parseInt(a.getAttribute("yPositionPercent")),0,100,0,f.boardSize.y),this.revealThreshold=parseInt(a.getAttribute("revealThreshold")),this.imageLink=c+a.getAttribute("imageLink"),this.feedbacks=a.getElementsByTagName("feedback"),this.blob=null,this.fileName="";var i=a.getElementsByTagName("connections");this.connections=[];for(var j=0;j<i.length;j++)this.connections[j]=parseInt(i[j].innerHTML);switch(this.questionType=parseInt(a.getAttribute("questionType")),this.justification=1==this.questionType||3==this.questionType,5!=this.questionType&&(this.createTaskWindow(a,h.taskWindow),this.createResourceWindow(a,b,h.resourceWindow,h.resource)),this.questionType){case 5:this.createMessageWindow(a,h.messageWindow);break;case 4:this.createFileWindow(h.fileWindow);break;case 3:case 2:case 1:this.createAnswerWindow(a,h.answerWindow)}}var e=a("./utilities.js"),f=a("./constants.js"),g=Object.freeze({HIDDEN:0,UNSOLVED:1,SOLVED:2}),h=Object.freeze({JUSTIFICATION:1,MULTIPLE_CHOICE:2,SHORT_RESPONSE:3,FILE:4,MESSAGE:5}),i=d.prototype;i.showPrevSubmittedFiles=function(a){a.length>0?this.feedback.innerHTML="Submitted Files:<br/>":this.feedback.innerHTML="";for(var b=0;a>b;b++)this.feedback.innerHTML+='<span class="feedbackI">'+a[b].name+"</span><br/>"},i.wrongAnswer=function(a){this.feedbacks.length>0&&(this.feedback.innerHTML='"'+String.fromCharCode(a+"A".charCodeAt())+'" is not correct <br/>&nbsp;<span class="feedbackI">'+this.feedbacks[a].innerHTML+"</span><br/>")},i.correctAnswer=function(){if(this.answers)for(var a=0;a<this.answers.length;a++)this.answers[a].disabled=!0;if(this.feedbacks.length>0&&(this.feedback.innerHTML='"'+String.fromCharCode(this.correct+"A".charCodeAt())+'" is the correct response <br/><span class="feedbackI">'+this.feedbacks[this.correct].innerHTML+"</span><br/>"),3===this.questionType&&""!=this.justification.value&&(this.feedback.innerHTML='Submitted Text:<br/><span class="feedbackI">'+this.justification.value+"</span><br/>"),1===this.questionType&&""!=this.justification.value&&(this.feedback.innerHTML+='Submitted Text:<br/><span class="feedbackI">'+this.justification.value+"</span><br/>"),4===this.questionType){this.fileInput.files.length>0?this.feedback.innerHTML="Submitted Files:<br/>":this.feedback.innerHTML="";for(var a=0;a<this.fileInput.files.length;a++)this.feedback.innerHTML+='<span class="feedbackI">'+this.fileInput.files[a].name+"</span><br/>"}this.currentState!=g.SOLVED&&((3===this.questionType||1===this.questionType)&&""!=this.justification.value||4===this.questionType&&this.fileInput.files.length>0||2===this.questionType)&&(this.currentState=g.SOLVED,this.proceedElement&&(this.proceedElement.style.display="block"))},i.displayWindows=function(){var a=this.windowDiv,b=new Image;b.src="../img/iconClose.png",b.className="exit-button";var c=this;b.onclick=function(){c.windowDiv.innerHTML=""},5===this.questionType?(a.appendChild(this.message),b.style.left="75vw"):(a.appendChild(this.task),a.appendChild(this.answer),a.appendChild(this.resource),b.style.left="85vw"),this.currentState===g.SOLVED&&this.questionType!=h.MESSAGE&&this.proceedElement&&(this.proceedElement.style.display="block"),a.appendChild(b)},i.createTaskWindow=function(a,b){this.proceedElement=document.getElementById("proceedContainer"),this.task=document.createElement("DIV"),this.task.className="window",this.task.style.top="10vh",this.task.style.left="5vw",this.task.innerHTML=b,this.task.innerHTML=this.task.innerHTML.replace("%title%",a.getElementsByTagName("questionName")[0].innerHTML.replace(/\n/g,"<br/>")),this.task.innerHTML=this.task.innerHTML.replace("%instructions%",a.getElementsByTagName("instructions")[0].innerHTML.replace(/\n/g,"<br/>")),this.task.innerHTML=this.task.innerHTML.replace("%question%",a.getElementsByTagName("questionText")[0].innerHTML.replace(/\n/g,"<br/>")),this.feedback=this.task.getElementsByClassName("feedback")[0]},i.createResourceWindow=function(a,b,c,d){this.resource=document.createElement("DIV"),this.resource.className="window",this.resource.style.top="55vh",this.resource.style.left="5vw",this.resource.innerHTML=c;var e=a.getElementsByTagName("resourceIndex");if(e.length>0){for(var f="",g=0;g<e.length;g++){var h=d.replace("%icon%",b[parseInt(e[g].innerHTML)].icon);h=h.replace("%title%",b[parseInt(e[g].innerHTML)].title),h=h.replace("%link%",b[parseInt(e[g].innerHTML)].link),f+=h}this.resource.innerHTML=this.resource.innerHTML.replace("%resources%",f)}else this.resource.innerHTML=this.resource.innerHTML.replace("%resources%","No resources have been provided for this task."),this.resource.getElementsByClassName("windowContent")[0].style.color="grey",this.resource.getElementsByClassName("windowContent")[0].style.backgroundColor="#FFFFFF",this.resource.getElementsByClassName("windowContent")[0].className+=", center"},i.createAnswerWindow=function(a,b){this.answer=document.createElement("DIV"),this.answer.className="window",this.answer.style.top="10vh",this.answer.style.left="50vw",this.answer.innerHTML=b;var c=this;this.justification&&(this.justification=document.createElement("textarea"),this.justification.submit=document.createElement("button"),this.justification.submit.className="submit",this.justification.submit.innerHTML="Submit",this.justification.submit.disabled=!0,this.justification.submit.onclick=function(){c.correctAnswer()},this.justification.addEventListener("input",function(){c.justification.value.length>0?c.justification.submit.disabled=!1:c.justification.submit.disabled=!0},!1)),this.answers=[];for(var d=a.getElementsByTagName("answer"),e=parseInt(a.getAttribute("correctAnswer")),f=0;f<d.length;f++)this.justification&&(this.justification.disabled=!0),this.answers[f]=document.createElement("button"),e===f?this.answers[f].className="correct":this.answers[f].className="wrong",this.answers[f].innerHTML=String.fromCharCode(f+"A".charCodeAt())+". "+d[f].innerHTML;for(var f=0;f<this.answers.length;f++)"wrong"==this.answers[f].className?(this.answers[f].num=f,this.answers[f].onclick=function(){this.disabled=!0,c.wrongAnswer(this.num)}):this.answers[f].onclick=function(){c.justification&&(c.justification.disabled=!1),c.correctAnswer()};for(var f=0;f<this.answers.length;f++)this.answer.getElementsByClassName("windowContent")[0].appendChild(this.answers[f]);this.justification&&(this.answer.getElementsByClassName("windowContent")[0].appendChild(this.justification),this.answer.getElementsByClassName("windowContent")[0].appendChild(this.justification.submit))},i.createFileWindow=function(a){this.answer=document.createElement("DIV"),this.answer.className="window",this.answer.style.top="10vh",this.answer.style.left="50vw",this.answer.innerHTML=a,this.fileInput=this.answer.getElementsByTagName("input")[0];var b=this;this.fileInput.addEventListener("change",function(a){b.fileName=a.target.files[0].name,b.blob=a.target.files[0].slice(),b.correctAnswer()})},i.createMessageWindow=function(a,b){this.message=document.createElement("DIV"),this.message.className="window",this.message.style.top="10vh",this.message.style.left="40vw",this.message.innerHTML=b,this.message.innerHTML=this.message.innerHTML.replace("%title%",a.getElementsByTagName("questionName")[0].innerHTML.replace(/\n/g,"<br/>")),this.message.innerHTML=this.message.innerHTML.replace("%instructions%",a.getElementsByTagName("instructions")[0].innerHTML.replace(/\n/g,"<br/>")),this.message.innerHTML=this.message.innerHTML.replace("%question%",a.getElementsByTagName("questionText")[0].innerHTML.replace(/\n/g,"<br/>"));var c=this;this.message.getElementsByTagName("button")[0].onclick=function(){c.currentState=g.SOLVED,c.windowDiv.innerHTML=""}},b.exports=d,b.exports.SOLVE_STATE=g},{"./constants.js":5,"./utilities.js":17}],15:[function(a,b,c){function d(a){this.loadWindows(a)}var e=d.prototype;e.loadWindows=function(a){var b=0,c=function(){++b>=6&&a&&a()};this.loadTaskWindow(c),this.loadResourceWindow(c),this.loadAnswerWindow(c),this.loadFileWindow(c),this.loadMessageWindow(c),this.loadResource(c)},e.loadTaskWindow=function(a){var b=this,c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status&&(b.taskWindow=c.responseText,a&&a())},c.open("GET","taskWindow.html",!0),c.send()},
e.loadResourceWindow=function(a){var b=this,c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status&&(b.resourceWindow=c.responseText,a&&a())},c.open("GET","resourceWindow.html",!0),c.send()},e.loadResource=function(a){var b=this,c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status&&(b.resource=c.responseText,a&&a())},c.open("GET","resource.html",!0),c.send()},e.loadAnswerWindow=function(a){var b=this,c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status&&(b.answerWindow=c.responseText,a&&a())},c.open("GET","answerWindow.html",!0),c.send()},e.loadFileWindow=function(a){var b=this,c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status&&(b.fileWindow=c.responseText,a&&a())},c.open("GET","fileWindow.html",!0),c.send()},e.loadMessageWindow=function(a){var b=this,c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&200==c.status&&(b.messageWindow=c.responseText,a&&a())},c.open("GET","messageWindow.html",!0),c.send()},b.exports=d},{}],16:[function(a,b,c){"use strict";function d(a,b){var c=parseInt(a.getAttribute("type"));switch(c){case 0:this.icon="../img/iconResourceFile.png";break;case 1:this.icon="../img/iconResourceLink.png";break;case 2:this.icon="../img/iconResourceVideo.png";break;default:this.icon=""}this.title=a.getAttribute("text"),c>0?this.link=a.getAttribute("link"):this.link=b+"assets/files/"+a.getAttribute("link").replace(/ /g,"%20")}a("./question.js");b.exports=d},{"./question.js":14}],17:[function(a,b,c){"use strict";var d=a("./point.js"),e=b.exports;e.getMouse=function(a){return new d(a.pageX-a.target.offsetLeft,a.pageY-a.target.offsetTop)},e.map=function(a,b,c,d,e){return d+(e-d)*((a-b)/(c-b))},e.clamp=function(a,b,c){return Math.max(b,Math.min(c,a))},e.mouseIntersect=function(a,b,c){return a.virtualPosition.x>b.position.x-b.width/2-c.x&&a.virtualPosition.x<b.position.x+b.width/2-c.x?a.virtualPosition.y>b.position.y-b.height/2-c.y&&a.virtualPosition.y<b.position.y+b.height/2-c.y:!1},e.getXml=function(a){var b;if(window.DOMParser){var c=new DOMParser;b=c.parseFromString(a,"text/xml")}else b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a);return b},e.getScale=function(a,b){return b.y/a.x*a.y<b.x?b.y/a.y:b.x/a.x},e.replaceAll=function(a,b,c){for(;a.indexOf(b)<0;)a=a.replace(b,c);return a}},{"./point.js":13}]},{},[1,2,3,4,5,7,8,9,10,11,12,13,14,15,16,17]);